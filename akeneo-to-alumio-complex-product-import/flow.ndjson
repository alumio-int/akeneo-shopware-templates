{"$schema":"https://di.schema.alumio.com/register.configuration.json","type":"scheduler-entry","identifier":"akeneo-fetch-complex-products","name":"Akeneo - Fetch complex products","object":{"parameters":{"job":[{"prototype":"run-incoming","parameters":{"incoming":"akeneo-fetch-products-with-parent"}},{"prototype":"run-incoming","parameters":{"incoming":"akeneo-fetch-product-models-without-parent"}},{"prototype":"run-incoming","parameters":{"incoming":"akeneo-fetch-product-models-with-parent"}}],"handlers":[],"priority":2,"expression":"*/30 * * * *"}},"description":"Akeneo has different structure than Shopware regarding product data structure. There some relation between products and product model which will be transform into product with variant in Shopware. We make an Alumio base product model to accommodate this.","owner":null,"disabled":true}
{"$schema":"https://di.schema.alumio.com/register.configuration.json","type":"incoming-configuration","identifier":"akeneo-fetch-products-with-parent","name":"Akeneo - Fetch - Products with parent","object":{"parameters":{"entityType":"base-product-model","subscriber":{"prototype":"http-subscriber","parameters":{"client":"akeneo-http-client","request":{"uri":"/api/rest/v1/products?limit=100&pagination_type=search_after&search=&{search}","payload":[],"plugins":[],"payloadType":"data","authentications":[]},"pagination":{"prototype":"next","parameters":{"pattern":"_links.next","pageLimit":10000}},"transformer":{"meta":[],"prototype":"value-setter","parameters":{"configurations":[{"key":"search","value":{"parent":[{"operator":"NOT EMPTY"}]},"mappers":[{"prototype":"serialize-json","parameters":[]}]}]}},"deserializer":{"prototype":"json","parameters":{"pattern":"_embedded.items","readMethod":"wholeFile","encodeInput":false}},"requestListeners":[]}},"transformers":["akeneo-prepare-convert-localizations-filter","akeneo-prepare-convert-values-to-localizations-and-custom-attributes","akeneo-prepare-convert-product-and-product-model-categories-to-alumio-base","akeneo-prepare-convert-product-and-product-model-prices-to-alumio-base","akeneo-convert-product-to-alumio-base-product","akeneo-update-storage-product-model-variants-alumio-base-product"]}},"description":"We defined variants as the product of a product model. Before we fetch the product model in Akeneo, we need to prepare the variants first (the product of the product model). This Incoming is designed to get products in Akeneo which have parent, so we can be sure this will be variant from the product model. This Incoming will not create any task but will update the storage of **\"Akeneo - Update Storage - Product Model Variants - Alumio Base Product\"** with a list of product data in Alumio base product data.","owner":null,"disabled":false}
{"$schema":"https://di.schema.alumio.com/register.configuration.json","type":"http-client","identifier":"akeneo-http-client","name":"Akeneo - HTTP Client","object":{"prototype":"akeneo-http-client-v2","parameters":{"key":"","baseUri":"${AKENEO_BASE_URL}","advanced":[],"clientId":"${AKENEO_CLIENT_ID}","password":"${AKENEO_PASSWORD}","username":"${AKENEO_USERNAME}","clientSecret":"${AKENEO_CLIENT_SECRET}","enableLogging":true,"loggerFormatter":"full"}},"description":"","owner":null,"disabled":false}
{"$schema":"https://di.schema.alumio.com/register.configuration.json","type":"entity","identifier":"base-product-model","name":"Base - Product Model","object":{"parameters":{"link":"https://schemas.alumio.com/v2/ProductModel.json","schema":{"$ref":"https://schemas.alumio.com/v2/ProductModel.json"},"identifierPath":["code"]}},"description":"","owner":null,"disabled":false}
{"$schema":"https://di.schema.alumio.com/register.configuration.json","type":"list-transformer","identifier":"akeneo-prepare-convert-localizations-filter","name":"Akeneo - Prepare Convert - Localizations filter","object":{"meta":[],"prototype":"chain","parameters":{"transformers":[{"meta":[],"prototype":"node","parameters":{"accessor":{"prototype":"key","parameters":{"keys":[],"root":"localizations"}},"nodeFilters":[{"prototype":"or-condition","parameters":{"filters":[{"prototype":"and-condition","parameters":{"filters":[{"prototype":"key-condition","parameters":{"filter":{"prototype":"key-exists-condition","parameters":{"path":"channelCode"}}}},{"prototype":"value-condition-v2","parameters":{"accessor":{"prototype":"pattern","parameters":{"keys":[],"pattern":"channelCode"}},"conditions":[{"prototype":"one-of","parameters":{"value":["ecommerce"]}}]}}]}},{"prototype":"key-condition","parameters":{"filter":{"prototype":"key-not-exists-condition","parameters":{"path":"channelCode"}}}}]}}],"nodeTransformers":[]}},{"meta":[],"prototype":"data","parameters":{"filters":[],"transformers":[{"meta":[],"prototype":"value-mapper","parameters":{"mappers":[{"prototype":"list-values","parameters":[]}],"accessor":{"prototype":"pattern","parameters":{"keys":[],"pattern":"localizations"}}}}]}}]}},"description":"We use this transformer to only allow any localization with channel code in **\"eCommerce\"**, if it has channel code.\n\nIf you need other channel code please add the value in the Node Filter.","owner":null,"disabled":false}
{"$schema":"https://di.schema.alumio.com/register.configuration.json","type":"list-transformer","identifier":"akeneo-prepare-convert-values-to-localizations-and-custom-attributes","name":"Akeneo - Prepare convert - Values - To localizations and custom attributes","object":{"meta":[],"prototype":"chain","parameters":{"transformers":[{"meta":[],"prototype":"node","parameters":{"accessor":{"prototype":"pattern","parameters":{"keys":[],"pattern":"values.*.*"}},"nodeFilters":[],"nodeTransformers":[{"meta":[],"prototype":"conditional","parameters":{"filters":[{"prototype":"value-condition-v2","parameters":{"accessor":{"prototype":"pattern","parameters":{"keys":[],"pattern":"attribute_type"}},"conditions":[{"prototype":"equals","parameters":{"value":"pim_catalog_image"}}]}}],"elseCases":[],"transformers":[{"meta":[],"prototype":"value-remover","parameters":{"patterns":[{"key":"_links"}]}}],"elseTransformers":[]}},{"meta":[],"prototype":"value-setter","parameters":{"configurations":[{"key":"combinedKey","value":"locale:?{locale}|scope:?{scope}","mappers":[]}]}},{"meta":[],"prototype":"value-remover","parameters":{"patterns":[{"key":"attribute_type"},{"key":"reference_data_name"}]}},{"meta":[],"prototype":"value-filter","parameters":{"accessor":{"prototype":"key","parameters":{"keys":[]}},"conditions":[{"prototype":"logic-or","parameters":{"conditions":[{"prototype":"equals","parameters":{"value":[]}},{"prototype":"equals","parameters":{"value":null}}]}}]}}]}},{"meta":[],"prototype":"node","parameters":{"accessor":{"prototype":"pattern","parameters":{"keys":[],"pattern":"values.*"}},"nodeFilters":[],"nodeTransformers":[{"meta":[],"prototype":"accessor-move","parameters":{"source":{"prototype":"structure","parameters":{"key":"combinedKey","keys":[],"value":"\"\""}},"destination":{"prototype":"key","parameters":{"keys":[]}},"stripEnclosures":true}}]}},{"meta":[],"prototype":"data","parameters":{"filters":[],"transformers":[{"meta":[],"prototype":"pattern-move","parameters":{"pattern":"values.*.*","conditions":[],"replacement":"values.$2.$1"}},{"meta":[],"prototype":"value-filter","parameters":{"accessor":{"prototype":"key","parameters":{"keys":[],"root":"values"}},"conditions":[{"prototype":"logic-or","parameters":{"conditions":[{"prototype":"equals","parameters":{"value":[]}},{"prototype":"equals","parameters":{"value":null}}]}}]}},{"meta":[],"prototype":"value-remover","parameters":{"patterns":[{"key":"values.*.*.combinedKey"}]}}]}},{"meta":[],"prototype":"node","parameters":{"accessor":{"prototype":"pattern","parameters":{"keys":[],"pattern":"values.*"}},"nodeFilters":[],"nodeTransformers":[{"meta":[],"prototype":"pattern-move","parameters":{"pattern":"*.data","conditions":[],"replacement":"customAttributes.$1"}},{"meta":[],"prototype":"pattern-move","parameters":{"pattern":"*.scope","conditions":[],"replacement":"channelCode"}},{"meta":[],"prototype":"pattern-move","parameters":{"pattern":"*.locale","conditions":[],"replacement":"localeCode"}},{"meta":[],"prototype":"value-filter","parameters":{"accessor":{"prototype":"key","parameters":{"keys":[]}},"conditions":[{"prototype":"logic-or","parameters":{"conditions":[{"prototype":"equals","parameters":{"value":[]}},{"prototype":"equals","parameters":{"value":null}}]}}]}}]}},{"meta":[],"prototype":"data","parameters":{"filters":[],"transformers":[{"meta":[],"prototype":"pattern-move","parameters":{"pattern":"values.\"locale:|scope:\".customAttributes","conditions":[],"replacement":"customAttributes"}},{"meta":[],"prototype":"value-filter","parameters":{"accessor":{"prototype":"pattern","parameters":{"keys":[],"pattern":"values.*"}},"conditions":[{"prototype":"logic-or","parameters":{"conditions":[{"prototype":"equals","parameters":{"value":[]}},{"prototype":"equals","parameters":{"value":null}}]}}]}},{"meta":[],"prototype":"value-mapper","parameters":{"mappers":[{"prototype":"list-values","parameters":[]}],"accessor":{"prototype":"pattern","parameters":{"keys":[],"pattern":"values"}}}},{"meta":[],"prototype":"pattern-move","parameters":{"pattern":"values","conditions":[],"replacement":"localizations"}}]}}]}},"description":"This transformer will convert localizations data from Akeneo.","owner":null,"disabled":false}
{"$schema":"https://di.schema.alumio.com/register.configuration.json","type":"list-transformer","identifier":"akeneo-prepare-convert-product-and-product-model-categories-to-alumio-base","name":"Akeneo - Prepare convert - Product and product model - Categories to Alumio Base","object":{"prototype":"chain","parameters":{"transformers":[{"meta":[],"prototype":"data","parameters":{"filters":[],"transformers":[{"meta":[],"prototype":"accessor-move","parameters":{"source":{"prototype":"key","parameters":{"keys":[],"root":"categories"}},"destination":{"prototype":"structure","parameters":{"key":"temp","keys":[],"root":"categories","value":"categoryCode"}},"stripEnclosures":true}}]}},{"meta":[],"prototype":"node","parameters":{"accessor":{"prototype":"key","parameters":{"keys":[],"root":"categories"}},"nodeFilters":[],"nodeTransformers":[{"meta":[],"prototype":"value-remover","parameters":{"patterns":[{"key":"temp"}]}}]}},{"meta":[],"prototype":"data","parameters":{"filters":[],"transformers":[{"meta":[],"prototype":"value-mapper","parameters":{"mappers":[{"prototype":"list-values","parameters":[]}],"accessor":{"prototype":"pattern","parameters":{"keys":[],"pattern":"categories"}}}}]}}]}},"description":"Akeneo - Prepare convert - Product and product model - Categories to Alumio Base","owner":null,"disabled":false}
{"$schema":"https://di.schema.alumio.com/register.configuration.json","type":"list-transformer","identifier":"akeneo-prepare-convert-product-and-product-model-prices-to-alumio-base","name":"Akeneo - Prepare convert - Product and product model - Prices to Alumio Base","object":{"prototype":"chain","parameters":{"transformers":[{"meta":[],"prototype":"data","parameters":{"filters":[],"transformers":[{"meta":[],"prototype":"pattern-move","parameters":{"pattern":"customAttributes.price","conditions":[],"replacement":"prices"}}]}},{"meta":[],"prototype":"node","parameters":{"accessor":{"prototype":"pattern","parameters":{"keys":[],"pattern":"prices.*"}},"nodeFilters":[],"nodeTransformers":[{"meta":[],"prototype":"pattern-move","parameters":{"pattern":"currency","conditions":[],"replacement":"currencyCode"}}]}}]}},"description":"Akeneo - Prepare convert - Product and product model - Prices to Alumio Base.","owner":null,"disabled":false}
{"$schema":"https://di.schema.alumio.com/register.configuration.json","type":"list-transformer","identifier":"akeneo-convert-product-to-alumio-base-product","name":"Akeneo - Convert - Product - To Alumio Base product","object":{"meta":[],"prototype":"chain","parameters":{"transformers":[{"meta":[],"prototype":"data","parameters":{"filters":[],"transformers":[{"prototype":"value-setter","parameters":{"configurations":[{"key":"code","value":"&{customAttributes.sku || identifier}","mappers":[]}]}},{"meta":[],"prototype":"key-mapper","parameters":{"mappers":[{"prototype":"dictionary-map","parameters":{"map":[["parent","parentCode"],["enabled","statusCode"],["family","attributeSetCode"]],"comparator":"equals"}}],"accessor":{"prototype":"key","parameters":{"keys":[]}},"stripEnclosures":true}},{"meta":[],"prototype":"value-remover","parameters":{"patterns":[{"key":"uuid"},{"key":"_links"},{"key":"created"},{"key":"updated"},{"key":"associations"},{"key":"quantified_associations"},{"key":"metadata"}]}}]}}]}},"description":"This transformer will convert Akeneo product data into Alumio base product data.","owner":null,"disabled":false}
{"$schema":"https://di.schema.alumio.com/register.configuration.json","type":"list-transformer","identifier":"akeneo-update-storage-product-model-variants-alumio-base-product","name":"Akeneo - Update Storage - Product Model Variants - Alumio Base Product","object":{"prototype":"chain","parameters":{"transformers":[{"meta":[],"prototype":"data","parameters":{"filters":[],"transformers":[{"meta":[],"prototype":"pattern-move","parameters":{"pattern":"*","conditions":[],"replacement":"variant.$1"}},{"meta":[],"prototype":"storage-get-entity-from-storage","parameters":{"storage":"akeneo-product-model-variants-alumio-base-product","storageKey":"&{variant.parentCode}","destination":"variants"}},{"meta":[],"prototype":"conditional","parameters":{"filters":[{"prototype":"or-condition","parameters":{"filters":[{"prototype":"key-condition","parameters":{"filter":{"prototype":"key-not-exists-condition","parameters":{"path":"variants"}}}},{"prototype":"value-condition-v2","parameters":{"accessor":{"prototype":"pattern","parameters":{"keys":[],"pattern":"variants"}},"conditions":[{"prototype":"logic-or","parameters":{"conditions":[{"prototype":"equals","parameters":{"value":[]}},{"prototype":"equals","parameters":{"value":null}}]}}]}}]}}],"elseCases":[],"transformers":[{"meta":[],"prototype":"pattern-copy","parameters":{"pattern":"variant","conditions":[],"replacement":"variants.0"}}],"elseTransformers":[{"meta":[],"prototype":"list-transformer-wrapper","parameters":{"transformers":["akeneo-prepare-update-product-model-variants-alumio-base-variant-merge"]}}]}},{"meta":[],"prototype":"storage-save-entity-in-storage","parameters":{"source":"variants","storage":"akeneo-product-model-variants-alumio-base-product","storageKey":"&{variant.parentCode}"}}]}}]}},"description":"This transformer will create a list of variants from the Alumio base product.","owner":null,"disabled":false}
{"$schema":"https://di.schema.alumio.com/register.configuration.json","type":"storage","identifier":"akeneo-product-model-variants-alumio-base-product","name":"Akeneo - Product Model variants - Alumio Base Product","object":{"parameters":{"path":"akeneo-product-model-variants-alumio-base-product-01K9SM642Q5AWV5DED20EQCAFM","logger":{"parameters":{"actions":[]}}}},"description":"","owner":null,"disabled":false}
{"$schema":"https://di.schema.alumio.com/register.configuration.json","type":"list-transformer","identifier":"akeneo-prepare-update-product-model-variants-alumio-base-variant-merge","name":"Akeneo - Prepare update - Product Model Variants - Alumio Base Variant merge","object":{"prototype":"chain","parameters":{"transformers":[{"meta":[],"prototype":"node","parameters":{"accessor":{"prototype":"pattern","parameters":{"keys":[],"pattern":"variants"}},"nodeFilters":[],"nodeTransformers":[{"meta":[],"prototype":"accessor-move","parameters":{"source":{"prototype":"structure","parameters":{"key":"code","keys":[],"value":"\"\""}},"destination":{"prototype":"key","parameters":{"keys":[]}},"stripEnclosures":true}}]}},{"meta":[],"prototype":"data","parameters":{"filters":[],"transformers":[{"meta":[],"prototype":"value-setter","parameters":{"configurations":[{"key":"variants.&{variant.code}","value":"&{variant}","mappers":[]}]}},{"meta":[],"prototype":"value-mapper","parameters":{"mappers":[{"prototype":"list-values","parameters":[]}],"accessor":{"prototype":"pattern","parameters":{"keys":[],"pattern":"variants"}}}}]}}]}},"description":"This transformer will merge the variants of Alumio Base Product Model.","owner":null,"disabled":false}
{"$schema":"https://di.schema.alumio.com/register.configuration.json","type":"incoming-configuration","identifier":"akeneo-fetch-product-models-without-parent","name":"Akeneo - Fetch - Product Models without parent","object":{"parameters":{"entityType":"base-product-model","subscriber":{"prototype":"http-subscriber","parameters":{"client":"akeneo-http-client","request":{"uri":"/api/rest/v1/product-models?limit=100&pagination_type=search_after&search=&{search}","payload":[],"plugins":[],"serializer":{"prototype":"json","parameters":[]},"payloadType":"data","authentications":[]},"pagination":{"prototype":"next","parameters":{"pattern":"_links.next","pageLimit":10000}},"transformer":{"meta":[],"prototype":"value-setter","parameters":{"configurations":[{"key":"search","value":{"parent":[{"operator":"EMPTY"}]},"mappers":[{"prototype":"serialize-json","parameters":[]}]}]}},"deserializer":{"prototype":"json","parameters":{"pattern":"_embedded.items","readMethod":"wholeFile","encodeInput":false}}}},"transformers":["akeneo-prepare-convert-values-to-localizations-and-custom-attributes","akeneo-prepare-convert-localizations-filter","akeneo-prepare-convert-product-and-product-model-categories-to-alumio-base","akeneo-prepare-convert-product-and-product-model-prices-to-alumio-base","akeneo-convert-product-model-to-alumio-base-product-model","alumio-fetch-storage-alumio-base-product-model-attach-variants","akeneo-update-storage-product-model-parent-alumio-base-product-model"]}},"description":"Parent product model in Akeneo has a probability to have children which is another product model or variant which is the product of the product model. This Incoming is designed to get a list of product model which is the top parent or doesn't have parent. This Incoming will not create any task but will update the storage of **\"Alumio - Product Model Parent - Alumio Base Product Model\"** with parent product model data in Alumio base product model.","owner":null,"disabled":false}
{"$schema":"https://di.schema.alumio.com/register.configuration.json","type":"list-transformer","identifier":"akeneo-convert-product-model-to-alumio-base-product-model","name":"Akeneo - Convert - Product Model - To Alumio Base Product Model","object":{"meta":[],"prototype":"chain","parameters":{"transformers":[{"meta":[],"prototype":"data","parameters":{"filters":[],"transformers":[{"meta":[],"prototype":"key-mapper","parameters":{"mappers":[{"prototype":"dictionary-map","parameters":{"map":[["parent","parentCode"],["enabled","statusCode"],["family","attributeSetCode"],["family_variant","attributeSetCodeVariant"]],"comparator":"equals"}}],"accessor":{"prototype":"key","parameters":{"keys":[]}},"stripEnclosures":true}},{"meta":[],"prototype":"value-remover","parameters":{"patterns":[{"key":"_links"},{"key":"created"},{"key":"updated"},{"key":"associations"},{"key":"quantified_associations"},{"key":"metadata"}]}}]}}]}},"description":"This transformer will convert Akeneo product model data into Alumio base product model data.","owner":null,"disabled":false}
{"$schema":"https://di.schema.alumio.com/register.configuration.json","type":"list-transformer","identifier":"alumio-fetch-storage-alumio-base-product-model-attach-variants","name":"Alumio - Fetch storage - Alumio Base Product Model attach variants","object":{"prototype":"chain","parameters":{"transformers":[{"meta":[],"prototype":"data","parameters":{"filters":[],"transformers":[{"meta":[],"prototype":"storage-get-entity-from-storage","parameters":{"storage":"akeneo-product-model-variants-alumio-base-product","storageKey":"&{code}","destination":"variants"}}]}}]}},"description":"This transformer will fetch the data of variant that was created from the Incoming **\"Akeneo - Fetch - Products with parent\"** and attach it as a variants to the Alumio base product model.","owner":null,"disabled":false}
{"$schema":"https://di.schema.alumio.com/register.configuration.json","type":"list-transformer","identifier":"akeneo-update-storage-product-model-parent-alumio-base-product-model","name":"Akeneo - Update storage - Product Model parent - Alumio Base Product Model","object":{"prototype":"data","parameters":{"filters":[],"transformers":[{"meta":[],"prototype":"storage-save-entity-in-storage","parameters":{"storage":"alumio-product-model-parent-alumio-base-product-model","storageKey":"&{code}"}}]}},"description":"This transformer will save the product model parent in the storage **\"Alumio - Product Model Parent - Alumio Base Product Model\"**.","owner":null,"disabled":false}
{"$schema":"https://di.schema.alumio.com/register.configuration.json","type":"storage","identifier":"alumio-product-model-parent-alumio-base-product-model","name":"Alumio - Product Model Parent - Alumio Base Product Model","object":{"parameters":{"path":"alumio-product-model-parent-alumio-base-product-model-01K9SM642XZSQAVRN3GQXJ2MYY","logger":{"parameters":{"actions":[]}}}},"description":"","owner":null,"disabled":false}
{"$schema":"https://di.schema.alumio.com/register.configuration.json","type":"incoming-configuration","identifier":"akeneo-fetch-product-models-with-parent","name":"Akeneo - Fetch - Product Models with parent","object":{"parameters":{"entityType":"base-product-model","subscriber":{"prototype":"http-subscriber","parameters":{"client":"akeneo-http-client","request":{"uri":"/api/rest/v1/product-models?limit=100&pagination_type=search_after&search=&{search}","payload":[],"plugins":[],"payloadType":"data","authentications":[]},"pagination":{"prototype":"next","parameters":{"pattern":"_links.next","pageLimit":10000}},"transformer":{"meta":[],"prototype":"value-setter","parameters":{"configurations":[{"key":"search","value":{"parent":[{"operator":"NOT EMPTY"}]},"mappers":[{"prototype":"serialize-json","parameters":[]}]}]}},"deserializer":{"prototype":"json","parameters":{"pattern":"_embedded.items","readMethod":"wholeFile","encodeInput":false}},"requestListeners":[]}},"transformers":["akeneo-prepare-convert-values-to-localizations-and-custom-attributes","akeneo-prepare-convert-localizations-filter","akeneo-prepare-convert-product-and-product-model-categories-to-alumio-base","akeneo-prepare-convert-product-and-product-model-prices-to-alumio-base","akeneo-convert-product-model-to-alumio-base-product-model","alumio-fetch-storage-alumio-base-product-model-attach-variants","akeneo-filter-and-prepare-update-storage-filter-for-product-model-without-variants-and-update-parent"]}},"description":"After we got the parent and the variant for a product model this is the time fetch children product model. This Incoming well get the product model with parent to become a children product model. This Incoming will not create any task but will update the storage of the parent at **\"Alumio - Product Model Parent - Alumio Base Product Model\"** with children product model data in Alumio base product model.","owner":null,"disabled":false}
{"$schema":"https://di.schema.alumio.com/register.configuration.json","type":"list-transformer","identifier":"akeneo-filter-and-prepare-update-storage-filter-for-product-model-without-variants-and-update-parent","name":"Akeneo - Filter and prepare update storage - Filter for product model without variants and update parent","object":{"prototype":"chain","parameters":{"transformers":[{"meta":[],"prototype":"conditional","parameters":{"filters":[{"prototype":"value-condition-v2","parameters":{"accessor":{"prototype":"pattern","parameters":{"keys":[],"pattern":"variants"}},"conditions":[{"prototype":"logic-and","parameters":{"conditions":[{"prototype":"not-equals","parameters":{"value":null}},{"prototype":"not-equals","parameters":{"value":[]}}]}}]}}],"transformers":["akeneo-update-storage-alumio-base-product-model-update-children"]}}]}},"description":"This transformer will filter product model without variant and will update the parent if not filtered.","owner":null,"disabled":false}
{"$schema":"https://di.schema.alumio.com/register.configuration.json","type":"list-transformer","identifier":"akeneo-update-storage-alumio-base-product-model-update-children","name":"Akeneo - Update storage - Alumio Base Product Model update children","object":{"prototype":"chain","parameters":{"transformers":[{"meta":[],"prototype":"data","parameters":{"filters":[],"transformers":[{"meta":[],"prototype":"pattern-move","parameters":{"pattern":"*","conditions":[],"replacement":"child.$1"}},{"meta":[],"prototype":"storage-get-entity-from-storage","parameters":{"storage":"alumio-product-model-parent-alumio-base-product-model","storageKey":"&{child.parentCode}","destination":"parent"}},{"meta":[],"prototype":"conditional","parameters":{"filters":[{"prototype":"or-condition","parameters":{"filters":[{"prototype":"key-condition","parameters":{"filter":{"prototype":"key-not-exists-condition","parameters":{"path":"parent.children"}}}},{"prototype":"value-condition-v2","parameters":{"accessor":{"prototype":"pattern","parameters":{"keys":[],"pattern":"parent.children"}},"conditions":[{"prototype":"logic-or","parameters":{"conditions":[{"prototype":"equals","parameters":{"value":[]}},{"prototype":"equals","parameters":{"value":null}}]}}]}}]}}],"elseCases":[],"transformers":[{"meta":[],"prototype":"pattern-move","parameters":{"pattern":"child","conditions":[],"replacement":"parent.children.0"}}],"elseTransformers":[{"meta":[],"prototype":"list-transformer-wrapper","parameters":{"transformers":["akeneo-prepare-update-alumio-base-product-model-merge-children-with-parent"]}}]}},{"meta":[],"prototype":"storage-save-entity-in-storage","parameters":{"source":"parent","storage":"alumio-product-model-parent-alumio-base-product-model","storageKey":"&{parent.code}"}}]}}]}},"description":"This transformer will update the parent product model inside the storage **\"Alumio - Product Model Parent - Alumio Base Product Model\"** with the product model provided in the data.","owner":null,"disabled":false}
{"$schema":"https://di.schema.alumio.com/register.configuration.json","type":"list-transformer","identifier":"akeneo-prepare-update-alumio-base-product-model-merge-children-with-parent","name":"Akeneo - Prepare update - Alumio Base Product Model merge children with parent","object":{"prototype":"chain","parameters":{"transformers":[{"meta":[],"prototype":"node","parameters":{"accessor":{"prototype":"pattern","parameters":{"keys":[],"pattern":"parent.children"}},"nodeFilters":[],"nodeTransformers":[{"meta":[],"prototype":"accessor-move","parameters":{"source":{"prototype":"structure","parameters":{"key":"code","keys":[],"value":"\"\""}},"destination":{"prototype":"key","parameters":{"keys":[]}},"stripEnclosures":true}}]}},{"meta":[],"prototype":"data","parameters":{"filters":[],"transformers":[{"meta":[],"prototype":"value-setter","parameters":{"configurations":[{"key":"parent.children.&{child.code}","value":"&{child}","mappers":[]}]}},{"meta":[],"prototype":"value-remover","parameters":{"patterns":[{"key":"child"}]}},{"meta":[],"prototype":"value-mapper","parameters":{"mappers":[{"prototype":"list-values","parameters":[]}],"accessor":{"prototype":"pattern","parameters":{"keys":[],"pattern":"parent.children"}}}}]}}]}},"description":"This transformer will merge the childrens of Alumio Base Product Model parent.","owner":null,"disabled":false}